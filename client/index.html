<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="/boostrap/5.2.0.min.css" />
    <link rel="stylesheet" href="http://localhost:5000/boostrap/icons-1.9.1.css" />
    <script defer>
      const deleteData = (id) =>
        fetch(`/data/${id}`, { method: 'DELETE' }).then((x) => window.location.reload());
      const row = ({ teacher, id, name, acad }) =>
        `<tr>
          <td>${id.slice(0, 3)}</td>
          <td>${acad}</td>
          <td>${name}</td>
          <td>${teacher}</td>
          <td>
            <a href="/view?id=${id}"><i class="bi bi-eye"></i></a>
            <i class="bi bi-trash" onclick="deleteData('${id}')"></i>
            </td>
          </tr>`;

      fetch('/data')
        .then((x) => x.json())
        .then((x) => x.map((i) => row(i)))
        .then((x) => (document.querySelector('tbody').innerHTML = x.join('')));
    </script>
  </head>
  <body>
    <main class="container">
      <section class="m-3">
        <a type="button" class="btn btn-primary m-3" href="/new">新增</a>
      </section>
      <section>
        <table class="table table-striped">
          <thead>
            <tr>
              <th scope="col">uid</th>
              <th scope="col">學年度</th>
              <th scope="col">課程名稱</th>
              <th scope="col">授課老師</th>
              <th scope="col">選項</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
    </main>
  </body>
</html>
